{{#> main}}

<div class="bg-gray-50 border-b border-gray-200 pt-32 pb-8">
    <div class="container mx-auto px-4">
        <nav class="flex text-sm font-medium text-gray-500 mb-4" aria-label="Breadcrumb">
            <ol class="inline-flex items-center space-x-1 md:space-x-3">
                <li class="inline-flex items-center">
                    <a href="/" class="hover:text-secondary">Inicio</a>
                </li>
                <li>
                    <div class="flex items-center">
                        <svg class="w-3 h-3 text-gray-400 mx-1" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
                            fill="none" viewBox="0 0 6 10">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="m1 9 4-4-4-4" />
                        </svg>
                        <a href="/vacantes" class="ml-1 hover:text-secondary">Vacantes</a>
                    </div>
                </li>
                <li aria-current="page">
                    <div class="flex items-center">
                        <svg class="w-3 h-3 text-gray-400 mx-1" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
                            fill="none" viewBox="0 0 6 10">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="m1 9 4-4-4-4" />
                        </svg>
                        <span class="ml-1 text-gray-700 truncate max-w-[200px] md:max-w-xs">{{vacante.titulo}}</span>
                    </div>
                </li>
            </ol>
        </nav>

        <div class="flex flex-col md:flex-row md:items-center justify-between gap-6">
            <div>
                <div class="flex items-center gap-3 mb-3">
                    {{#if vacante.categoria}}
                    <span
                        class="px-3 py-1 bg-blue-100 text-blue-700 rounded-lg text-xs font-bold uppercase tracking-wider">
                        {{vacante.categoria.nombre}}
                    </span>
                    {{/if}}
                    <span
                        class="px-3 py-1 bg-gray-200 text-gray-600 rounded-lg text-xs font-bold uppercase tracking-wider">
                        {{vacante.tipoContrato}}
                    </span>
                </div>
                <h1 class="text-3xl md:text-5xl font-black text-gray-900 mb-2">{{vacante.titulo}}</h1>
                <div class="flex items-center gap-6 text-gray-500 font-medium">
                    <span class="flex items-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z">
                            </path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                        </svg>
                        {{vacante.ubicacion}}
                    </span>
                    {{#if vacante.salario}}
                    <span class="flex items-center gap-2 text-green-600">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z">
                            </path>
                        </svg>
                        {{vacante.salario}}
                    </span>
                    {{/if}}
                </div>
            </div>
            <div>
                {{#if vacante.fechaCierre}}
                <div id="countdown-container" data-date="{{vacante.fechaCierre}}"
                    class="mb-6 p-4 rounded-2xl bg-gradient-to-br from-indigo-900 to-blue-900 text-white shadow-lg text-center hidden">
                    <p class="text-indigo-200 text-xs font-bold uppercase tracking-wider mb-2">Tiempo Restante</p>
                    <div class="flex items-center justify-center gap-4">
                        <div class="flex flex-col">
                            <span id="days" class="text-3xl font-black">00</span>
                            <span class="text-[10px] text-indigo-300 uppercase">Días</span>
                        </div>
                        <span class="text-2xl text-indigo-500">:</span>
                        <div class="flex flex-col">
                            <span id="hours" class="text-3xl font-black">00</span>
                            <span class="text-[10px] text-indigo-300 uppercase">Horas</span>
                        </div>
                        <span class="text-2xl text-indigo-500">:</span>
                        <div class="flex flex-col">
                            <span id="minutes" class="text-3xl font-black">00</span>
                            <span class="text-[10px] text-indigo-300 uppercase">Min</span>
                        </div>
                        <span class="text-2xl text-indigo-500">:</span>
                        <div class="flex flex-col">
                            <span id="seconds" class="text-3xl font-black">00</span>
                            <span class="text-[10px] text-indigo-300 uppercase">Seg</span>
                        </div>
                    </div>
                </div>
                <script>
                    document.addEventListener('DOMContentLoaded', () => {
                        const container = document.getElementById('countdown-container');
                        const dateStr = container.dataset.date;
                        if (!dateStr) return;

                        const targetDate = new Date(dateStr).getTime();

                        const updateCountdown = () => {
                            const now = new Date().getTime();
                            const distance = targetDate - now;

                            if (distance < 0) {
                                container.innerHTML = '<div class="text-center font-bold text-red-200">¡Esta oferta ha finalizado!</div>';
                                container.classList.remove('hidden');
                                clearInterval(interval);
                                return;
                            }

                            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                            document.getElementById('days').innerText = String(days).padStart(2, '0');
                            document.getElementById('hours').innerText = String(hours).padStart(2, '0');
                            document.getElementById('minutes').innerText = String(minutes).padStart(2, '0');
                            document.getElementById('seconds').innerText = String(seconds).padStart(2, '0');
                            container.classList.remove('hidden');
                        };

                        const interval = setInterval(updateCountdown, 1000);
                        updateCountdown();
                    });
                </script>
                {{/if}}

                {{#if yaPostulado}}
                <div
                    class="bg-green-50 border border-green-200 text-green-800 px-6 py-4 rounded-2xl flex flex-col items-center text-center">
                    <svg class="w-8 h-8 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                    <p class="font-bold text-lg">¡Ya te has postulado!</p>
                    <a href="/candidato" class="text-green-700 underline mt-1 hover:text-green-900">Ver estado de mi
                        postulación</a>
                </div>
                {{else}}
                <a href="/candidato/registro?vacante={{vacante.id}}"
                    class="inline-flex items-center justify-center px-8 py-4 border border-transparent text-lg font-bold rounded-2xl text-white bg-secondary hover:bg-secondary/90 transition-all shadow-xl shadow-secondary/30 hover:-translate-y-1 w-full md:w-auto">
                    Postularme Ahora
                </a>
                {{/if}}
            </div>
        </div>
    </div>
</div>

<div class="container mx-auto px-4 py-12">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">
        <div class="lg:col-span-2 space-y-12">

            {{#if vacante.imagen}}
            <div class="w-full rounded-3xl overflow-hidden shadow-lg border border-gray-100 mb-8">
                <img src="{{vacante.imagen}}" alt="{{vacante.titulo}}" class="w-full h-auto object-contain">
            </div>
            {{/if}}

            {{#if vacante.descripcion}}
            <section>
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Descripción del Puesto</h2>
                <div class="prose prose-lg prose-blue max-w-none text-gray-600">
                    {{{vacante.descripcion}}}
                </div>
            </section>
            {{/if}}

            {{#if vacante.requisitos}}
            <section>
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Requisitos</h2>
                <ul class="space-y-3">
                    {{#each vacante.requisitos}}
                    <li class="flex items-start gap-3">
                        <svg class="w-6 h-6 text-green-500 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor"
                            viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7">
                            </path>
                        </svg>
                        <span class="text-gray-600 text-lg">{{this}}</span>
                    </li>
                    {{/each}}
                </ul>
            </section>
            {{/if}}

            {{#if vacante.pasos}}
            <section>
                <h2 class="text-2xl font-bold text-gray-900 mb-6 mt-12">Pasos para Postularse</h2>
                <div
                    class="space-y-6 relative before:absolute before:inset-0 before:ml-5 before:-translate-x-px md:before:mx-auto md:before:translate-x-0 before:h-full before:w-0.5 before:bg-gradient-to-b before:from-transparent before:via-gray-300 before:to-transparent">
                    {{#each vacante.pasos}}
                    <div
                        class="relative flex items-center justify-between md:justify-normal md:odd:flex-row-reverse group is-active">
                        <div
                            class="flex items-center justify-center w-10 h-10 rounded-full border border-white bg-white group-[.is-active]:bg-secondary group-[.is-active]:text-white shadow shrink-0 md:order-1 md:group-odd:-translate-x-1/2 md:group-even:translate-x-1/2 z-10 font-bold">
                            {{sum @index 1}}
                        </div>
                        <div
                            class="w-[calc(100%-4rem)] md:w-[calc(50%-2.5rem)] bg-white p-4 rounded-xl border border-gray-100 shadow-sm">
                            <h3 class="font-bold text-gray-900 text-lg mb-1">{{this.titulo}}</h3>
                            <p class="text-gray-500">{{this.descripcion}}</p>
                        </div>
                    </div>
                    {{/each}}
                </div>
            </section>
            {{/if}}
        </div>

        <div class="space-y-6">
            <div class="bg-blue-50 rounded-2xl p-8 border border-blue-100">
                <h3 class="text-xl font-bold text-blue-900 mb-4">Resumen</h3>
                <ul class="space-y-4">
                    <li class="flex justify-between border-b border-blue-200 pb-2">
                        <span class="text-blue-700 font-medium">Ubicación</span>
                        <span class="text-gray-700">{{vacante.ubicacion}}</span>
                    </li>
                    <li class="flex justify-between border-b border-blue-200 pb-2">
                        <span class="text-blue-700 font-medium">Tipo</span>
                        <span class="text-gray-700">{{vacante.tipoContrato}}</span>
                    </li>
                    <li class="flex justify-between border-b border-blue-200 pb-2">
                        <span class="text-blue-700 font-medium">Publicado</span>
                        <span class="text-gray-700">{{formatDate vacante.fechaPublicacion}}</span>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

{{/main}}