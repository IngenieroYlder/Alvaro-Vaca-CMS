<!DOCTYPE html>
<html lang="es" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {{> seo}}

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800;900&family=Open+Sans:wght@400;600&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
        rel="stylesheet">

    <!-- Tailwind CSS -->
    <link rel="stylesheet" href="/assets/styles.css?v={{appVersion}}">
</head>

<body class="bg-background-light text-gray-800 font-body antialiased">

    <!-- Header -->
    {{> header}}

    <!-- Page Header -->
    <header class="pt-32 pb-12 bg-white border-b border-gray-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h1 class="font-display font-black text-4xl md:text-5xl text-gray-900 mb-4">Noticias y Actualidad</h1>
            <p class="text-lg text-gray-600 max-w-2xl">
                Mantente informado sobre nuestras actividades, propuestas legislativas y el movimiento verde en todo el
                país.
            </p>
        </div>
    </header>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-12">

            <!-- Left Column: News Grid (8 cols) -->
            <div class="lg:col-span-8">

                <!-- Filters -->
                <form action="/noticias" method="GET"
                    class="bg-white p-6 rounded-2xl shadow-sm mb-8 border border-gray-100">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <!-- Search -->
                        <div class="md:col-span-4 lg:col-span-2">
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Buscar</label>
                            <div class="relative">
                                <input type="text" name="busqueda" value="{{filtros.busqueda}}"
                                    placeholder="Palabras clave..."
                                    class="w-full pl-10 pr-4 py-2 rounded-lg border border-gray-200 focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-colors text-sm">
                                <span
                                    class="material-icons-round absolute left-3 top-2 text-gray-400 text-lg">search</span>
                            </div>
                        </div>
                        <!-- Category -->
                        <div class="md:col-span-2 lg:col-span-1">
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Categoría</label>
                            <select name="categoria" onchange="this.form.submit()"
                                class="w-full px-4 py-2 rounded-lg border border-gray-200 focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-colors bg-white text-sm">
                                <option value="">Todas</option>
                                {{#each categorias}}
                                <option value="{{this.slug}}" {{#if (eq ../filtros.categoria
                                    this.slug)}}selected{{/if}}>{{this.nombre}}</option>
                                {{/each}}
                            </select>
                        </div>
                        <!-- Button -->
                        <div class="md:col-span-2 lg:col-span-1 flex items-end">
                            <button type="submit"
                                class="w-full py-2 bg-primary text-white rounded-lg font-bold text-sm shadow hover:bg-green-800 transition-colors">Filtrar</button>
                        </div>
                    </div>
                </form>

                <!-- News Feed -->
                <div class="space-y-12">
                    {{#if noticias}}
                    {{#each noticias}}
                    <article
                        class="bg-white rounded-3xl overflow-hidden shadow-sm hover:shadow-xl transition-all duration-300 border border-gray-100 group">
                        <div class="grid md:grid-cols-2 gap-0 h-full">
                            <div class="relative h-64 md:h-full overflow-hidden">
                                {{#if this.imagenPrincipal}}
                                <img src="{{this.imagenPrincipal}}" alt="{{this.titulo}}"
                                    class="absolute inset-0 w-full h-full object-cover group-hover:scale-105 transition-transform duration-700"
                                    loading="lazy" width="800" height="600">
                                {{else}}
                                <div
                                    class="absolute inset-0 w-full h-full bg-gray-200 flex items-center justify-center">
                                    <span class="material-icons-round text-6xl text-gray-400">image</span>
                                </div>
                                {{/if}}
                                <div
                                    class="absolute top-4 left-4 bg-white/90 backdrop-blur-md px-3 py-1 rounded-full text-xs font-bold text-primary shadow-sm">
                                    {{#if this.categoria.nombre}}{{this.categoria.nombre}}{{else}}Noticia{{/if}}
                                </div>
                            </div>
                            <div class="p-8 flex flex-col justify-between">
                                <div>
                                    <div class="flex items-center text-xs text-gray-500 mb-3 space-x-2">
                                        <span class="flex items-center"><span
                                                class="material-icons-round text-sm mr-1">event</span> {{formatDate
                                            this.fechaPublicacion}}</span>
                                    </div>
                                    <h2
                                        class="font-display font-bold text-2xl text-gray-900 mb-3 leading-tight group-hover:text-primary transition-colors">
                                        <a href="/noticias/{{this.slug}}">{{this.titulo}}</a>
                                    </h2>
                                    <p class="text-gray-700 line-clamp-3 mb-6">{{this.resumen}}</p>
                                </div>
                                <a href="/noticias/{{this.slug}}"
                                    class="inline-flex items-center text-primary font-bold hover:text-green-800 transition-colors group/link">
                                    Leer nota completa
                                    <span
                                        class="material-icons-round ml-1 transform group-hover/link:translate-x-1 transition-transform">arrow_forward</span>
                                </a>
                            </div>
                        </div>
                    </article>
                    {{/each}}
                    {{else}}
                    <div class="text-center py-12 bg-white rounded-3xl border border-dashed border-gray-200">
                        <span class="material-icons-round text-6xl text-gray-200 mb-4">newspaper</span>
                        <h3 class="text-xl font-bold text-gray-400">No hay noticias disponibles.</h3>
                    </div>
                    {{/if}}
                </div>
            </div>

            <!-- Sidebar -->
            <div class="lg:col-span-4 space-y-8">
                <!-- Socials Widget -->
                <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100">
                    <h3 class="font-bold text-lg mb-4 flex items-center">
                        <span class="material-icons-round text-primary mr-2">share</span>
                        Síguenos
                    </h3>
                    <div class="grid grid-cols-3 gap-4">
                        <a href="https://www.facebook.com/profile.php?id=61584494686519" target="_blank"
                            class="flex flex-col items-center justify-center p-4 bg-blue-50 rounded-xl hover:bg-blue-100 transition-colors group">
                            <span
                                class="material-icons-round text-blue-600 text-2xl mb-1 group-hover:scale-110 transition-transform">facebook</span>
                            <span class="text-xs font-bold text-blue-800">Facebook</span>
                        </a>
                        <a href="https://www.instagram.com/alvarovacab/" target="_blank"
                            class="flex flex-col items-center justify-center p-4 bg-pink-50 rounded-xl hover:bg-pink-100 transition-colors group">
                            <span
                                class="material-icons-round text-pink-600 text-2xl mb-1 group-hover:scale-110 transition-transform">photo_camera</span>
                            <span class="text-xs font-bold text-pink-800">Instagram</span>
                        </a>
                        <a href="https://www.tiktok.com/@alvarovacab" target="_blank"
                            class="flex flex-col items-center justify-center p-4 bg-gray-900 rounded-xl hover:bg-gray-800 transition-colors group">
                            <svg class="w-6 h-6 mb-1 text-white group-hover:scale-110 transition-transform"
                                fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M12.525.02c1.31-.02 2.61-.01 3.91-.02.08 1.53.63 3.09 1.75 4.17 1.12 1.11 2.7 1.62 4.24 1.79v4.03c-1.44-.05-2.89-.35-4.2-.97-.57-.26-1.1-.65-1.62-1.12-1.09-.96-1.95-2.23-2.3-3.7-.09-.53-.13-1.07-.15-1.61H10.15c-.01 3.65-.01 7.3.02 10.95.04 1.79-.53 3.65-1.69 5.06-1.95 2.15-5.2 2.72-7.86 1.45-1.74-.9-2.93-2.61-3.21-4.59-.28-3.25 2.27-5.96 5.37-6.22 1.48-.12 2.97.43 4.14 1.34V6.4c-1.03-.55-2.18-.89-3.34-.98-3.04-.24-5.91 1.54-7.07 4.36-1.15 2.82.02 6.13 2.59 7.97 2.24 1.6 5.39 1.3 7.6-.74 1.25-1.16 1.98-2.8 1.99-4.52.02-4.14 0-8.29 0-12.43.01-.01.01-.01.01-.01z" />
                            </svg>
                            <span class="text-xs font-bold text-white">TikTok</span>
                        </a>
                    </div>
                </div>

                <!-- Facebook Feed -->
                <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-100 overflow-hidden">
                    <h3 class="font-bold text-lg mb-4 flex items-center">
                        <span class="material-icons-round text-blue-600 mr-2">facebook</span>
                        Nuestra Actividad
                    </h3>
                    <div class="flex justify-center">
                        <iframe
                            src="https://www.facebook.com/plugins/page.php?href=https%3A%2F%2Fwww.facebook.com%2Fprofile.php%3Fid%3D61584494686519&tabs=timeline&width=340&height=500&small_header=false&adapt_container_width=true&hide_cover=false&show_facepile=true&appId"
                            width="100%" height="500" style="border:none;overflow:hidden" scrolling="no" frameborder="0"
                            allowfullscreen="true"
                            allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share"></iframe>
                    </div>
                </div>

                <!-- CTA Box -->
                <div
                    class="bg-gradient-to-br from-primary to-secondary rounded-2xl p-8 text-white relative overflow-hidden">
                    <div
                        class="absolute top-0 right-0 w-32 h-32 bg-white opacity-10 rounded-full -translate-y-1/2 translate-x-1/2">
                    </div>
                    <div class="relative z-10">
                        <h3 class="font-display font-bold text-2xl mb-2">¡Únete al equipo!</h3>
                        <p class="text-green-100 text-sm mb-6">Necesitamos voluntarios digitales para difundir nuestro
                            mensaje.</p>
                        <button onclick="openJoinModal()"
                            class="w-full py-3 bg-white text-primary font-bold rounded-lg hover:bg-green-50 transition-colors shadow-lg">
                            Registrarme
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {{> footer}}

    <!-- Join Modal -->
    {{> join_modal}}

    <script>
        function openJoinModal() {
            const modal = document.getElementById('joinModal');
            if (modal) modal.classList.remove('hidden');
        }
        function closeJoinModal() {
            const modal = document.getElementById('joinModal');
            if (modal) modal.classList.add('hidden');
        }
    </script>
</body>

</html>